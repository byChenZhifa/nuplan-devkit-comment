这段代码定义了一个函数 `build_simulations`，用于根据提供的配置和输入参数构建并返回一组 `SimulationRunner` 对象。以下是对代码的详细解读：

1. **导入和设置**：
   - 导入了多种模块和类，包括日志记录工具、Hydra 的 `instantiate` 方法以及多个与场景、模拟和回调相关的类，这些都来自 `nuplan` 库。

2. **函数定义**：
   - `build_simulations` 函数接收以下参数：
     - `cfg`: 配置对象（`DictConfig`），用于运行实验。
     - `scenario_builder`: 场景构建器，用于提取场景。
     - `worker`: 工作池，用于任务执行。
     - `callbacks`: 模拟中的回调函数列表。
     - `callbacks_worker`（可选）：用于回调的工作池。
     - `pre_built_planners`（可选）：预构建的规划器列表。

3. **日志记录和初始设置**：
   - 使用日志记录来跟踪进度。创建一个空列表 `simulations` 来保存结果。

4. **场景检索**：
   - 创建一个场景过滤器，并使用场景构建器来检索场景。记录并输出获得的场景数量。

5. **度量引擎**：
   - 如果配置中启用了度量功能，则构建度量引擎并记录其状态。

6. **规划器和模拟设置**：
   - 对于每个场景：
     - 如果没有预构建的规划器，则根据配置构建规划器；否则使用提供的预构建规划器。
     - 实例化自我控制器、仿真时间控制器和观察模块，这些都基于配置进行设置。
     - 如果度量引擎存在，则创建 `MetricCallback` 实例并添加到回调列表中。
     - 根据配置创建 `SimulationSetup` 和 `Simulation` 对象，并将其与规划器一起封装到 `SimulationRunner` 中。

7. **返回结果**：
   - 函数完成后，记录日志并返回构建好的 `SimulationRunner` 对象列表。

总的来说，这个函数主要用于根据提供的配置和参数构建一系列的仿真运行器，适用于复杂的仿真环境设置和测试。